// @strict-types
#Область ПрограммныйИнтерфейс
// Получить.
// 
// Параметры:
//  УИД - УникальныйИдентификатор
// 
// Возвращаемое значение:
//  - Неопределено
//  - ДокументСсылка.РасписаниеНаДату
Функция Получить(УИД) Экспорт
	Запрос = Новый Запрос;
	Запрос.Текст =
	"ВЫБРАТЬ ПЕРВЫЕ 1
	|	РасписаниеНаДату.Ссылка
	|ИЗ
	|	Документ.РасписаниеНаДату КАК РасписаниеНаДату
	|ГДЕ
	|	УНИКАЛЬНЫЙИДЕНТИФИКАТОР(РасписаниеНаДату.Ссылка) = &УИД
	|	И РасписаниеНаДату.Проведен = ИСТИНА
	|	И РасписаниеНаДату.ПометкаУдаления = ЛОЖЬ";

	Запрос.УстановитьПараметр("УИД", УИД);
	
	РезультатЗапроса = Запрос.Выполнить();

	Если РезультатЗапроса.Пустой() Тогда
		Возврат Неопределено;
	КонецЕсли;

	Выборка = РезультатЗапроса.Выбрать();
	Выборка.Следующий();
	
	//@skip-check property-return-type
	Возврат Выборка.Ссылка;
КонецФункции

// Получить по электронной почте.
// 
// Параметры:
//  ДатаРасписания - Дата
// 
// Возвращаемое значение:
//  - Неопределено
//  - ДокументСсылка.РасписаниеНаДату
Функция ПолучитьПоДатеРасписания(ДатаРасписания) Экспорт
	Запрос = Новый Запрос;
	Запрос.Текст =
	"ВЫБРАТЬ ПЕРВЫЕ 1
	|	РасписаниеНаДату.Ссылка
	|ИЗ
	|	Документ.РасписаниеНаДату КАК РасписаниеНаДату
	|ГДЕ
	|	РасписаниеНаДату.ДатаРасписания = &ДатаРасписания
	|	И РасписаниеНаДату.Проведен = ИСТИНА
	|	И РасписаниеНаДату.ПометкаУдаления = ЛОЖЬ";

	Запрос.УстановитьПараметр("ДатаРасписания", ДатаРасписания);

	РезультатЗапроса = Запрос.Выполнить();

	Если РезультатЗапроса.Пустой() Тогда
		Возврат Неопределено;
	КонецЕсли;

	Выборка = РезультатЗапроса.Выбрать();
	Выборка.Следующий();
	
	//@skip-check property-return-type
	Возврат Выборка.Ссылка;
КонецФункции
#КонецОбласти